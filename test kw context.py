# Mảng data
import json

data = [{
    "fileName": "QVJR6F8NI94010LRFDI6FIFHMG1V3NJE.mp3",
    "agentChannel": 1,
    "time_load_info": 0.003962039947509766,
    "criterias_order": [],
    "context_analysis": {
        "searchInvalidKeyword": [
            {
                "raw_text": "alo",
                "keywords": [],
                "index": 3,
                "channel": 1,
                "text": "alo phạm chí nam đang nghe máy đúng không ạ bên fe alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
                "intent": "impolite",
                "intents": [
                    "impolite"
                ]
            },
            {
                "raw_text": "alo",
                "keywords": [],
                "index": 4,
                "channel": 1,
                "text": "phạm chí nam đang nghe máy đúng không ạ bên fe alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
                "intent": "impolite",
                "intents": [
                    "impolite"
                ]
            },
            {
                "raw_text": "bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
                "keywords": [],
                "index": 5,
                "channel": 1,
                "text": "alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
                "intent": "impolite",
                "intents": [
                    "impolite"
                ]
            }
        ]
    },
    "searchInvalidKeyword": {
        "evaluate": "yes",
        "evaluate_channel": {
            "1": "yes",
            "2": "no"
        },
        "decision_position": [
            {
                "raw_text": "alo",
                "keywords": [],
                "index": 3,
                "channel": 1,
                "text": "alo phạm chí nam đang nghe máy đúng không ạ bên fe alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
                "intent": "impolite",
                "intents": [
                    "impolite"
                ]
            },
            {
                "raw_text": "alo",
                "keywords": [],
                "index": 4,
                "channel": 1,
                "text": "phạm chí nam đang nghe máy đúng không ạ bên fe alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
                "intent": "impolite",
                "intents": [
                    "impolite"
                ]
            },
            {
                "raw_text": "bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
                "keywords": [],
                "index": 5,
                "channel": 1,
                "text": "alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
                "intent": "impolite",
                "intents": [
                    "impolite"
                ]
            }
        ],
        "decision": "yes",
        "confidence": 1.0,
        "confidence_channel": {
            "1": 1.0,
            "2": 0.0
        },
        "position": [
            {
                "raw_text": "alo",
                "keywords": [],
                "index": 3,
                "channel": 1,
                "text": "alo phạm chí nam đang nghe máy đúng không ạ bên fe alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
                "intent": "impolite",
                "intents": [
                    "impolite"
                ]
            },
            {
                "raw_text": "alo",
                "keywords": [],
                "index": 4,
                "channel": 1,
                "text": "phạm chí nam đang nghe máy đúng không ạ bên fe alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
                "intent": "impolite",
                "intents": [
                    "impolite"
                ]
            },
            {
                "raw_text": "bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
                "keywords": [],
                "index": 5,
                "channel": 1,
                "text": "alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
                "intent": "impolite",
                "intents": [
                    "impolite"
                ]
            }
        ],
        "slots": {},
        "position_range_index": [],
        "position_condition": [],
        "task": "context_analysis"
    }
}]

# Mảng transcript
transcript = [{
    "name":"QVJR6F8NI94010LRFDI6FIFHMG1V3NJE.mp3",
    "agentChannel":1,
    "content":[
      {
        "channel":1,
        "text":"alo cho mình hỏi phải phạm chí nam đang nghe máy không"
      },
      {
        "channel":1,
        "text":"alo"
      },
      {
        "channel":1,
        "text":"phạm chí nam đang nghe máy đúng không ạ bên fe"
      },
      {
        "channel":1,
        "text":"alo"
      },
      {
        "channel":1,
        "text":"alo"
      },
      {
        "channel":1,
        "text":"bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau"
      }
    ],
    "metadata":{
      "duration":"32390",
      "BUCKET_OR_REGION":"B3",
      "agentId":"29190",
      "GSW_CAMPAIGN_NAME":"COL_EC1_AG13_PEGA_CAMPAIGN",
      "USER_GENESYS":"doquangdat2",
      "startTime":"2024-11-27T07:53:06.000+0000",
      "LINE_MANAGER_1_TEAMLEADER":"Nguyễn Thị Bích Hạnh",
      "id":"QVJR6F8NI94010LRFDI6FIFHMG1V3NJE",
      "username":"doquangdat2"
    }
  },]
# Kiểm tra và gán BUCKET_OR_REGION từ transcript vào data nếu trùng fileName và name
for item_data in data:
    for item_transcript in transcript:
        if item_data["fileName"] == item_transcript["name"]:
            item_data["BUCKET_OR_REGION"] = item_transcript["metadata"]["BUCKET_OR_REGION"]

# In kết quả
data = json.dumps(item_data, ensure_ascii=False, indent=2)
print(data)

data = [{
    "fileName": "QVJR6F8NI94010LRFDI6FIFHMG1V3NJE.mp3",
    "agentChannel": 1,
    "time_load_info": 0.003962039947509766,
    "criterias_order": [],
    "context_analysis": {
      "searchInvalidKeyword": [
        {
          "raw_text": "alo",
          "keywords": [],
          "index": 3,
          "channel": 1,
          "text": "alo phạm chí nam đang nghe máy đúng không ạ bên fe alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
          "intent": "impolite",
          "intents": [
            "impolite"
          ]
        },
        {
          "raw_text": "alo",
          "keywords": [],
          "index": 4,
          "channel": 1,
          "text": "phạm chí nam đang nghe máy đúng không ạ bên fe alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
          "intent": "impolite",
          "intents": [
            "impolite"
          ]
        },
        {
          "raw_text": "bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
          "keywords": [],
          "index": 5,
          "channel": 1,
          "text": "alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
          "intent": "impolite",
          "intents": [
            "impolite"
          ]
        }
      ]
    },
    "searchInvalidKeyword": {
      "evaluate": "yes",
      "evaluate_channel": {
        "1": "yes",
        "2": "no"
      },
      "decision_position": [
        {
          "raw_text": "alo",
          "keywords": [],
          "index": 3,
          "channel": 1,
          "text": "alo phạm chí nam đang nghe máy đúng không ạ bên fe alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
          "intent": "impolite",
          "intents": [
            "impolite"
          ]
        },
        {
          "raw_text": "alo",
          "keywords": [],
          "index": 4,
          "channel": 1,
          "text": "phạm chí nam đang nghe máy đúng không ạ bên fe alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
          "intent": "impolite",
          "intents": [
            "impolite"
          ]
        },
        {
          "raw_text": "bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
          "keywords": [],
          "index": 5,
          "channel": 1,
          "text": "alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
          "intent": "impolite",
          "intents": [
            "impolite"
          ]
        }
      ],
      "decision": "yes",
      "confidence": 1.0,
      "confidence_channel": {
        "1": 1.0,
        "2": 0.0
      },
      "position": [
        {
          "raw_text": "alo",
          "keywords": [],
          "index": 3,
          "channel": 1,
          "text": "alo phạm chí nam đang nghe máy đúng không ạ bên fe alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
          "intent": "impolite",
          "intents": [
            "impolite"
          ]
        },
        {
          "raw_text": "alo",
          "keywords": [],
          "index": 4,
          "channel": 1,
          "text": "phạm chí nam đang nghe máy đúng không ạ bên fe alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
          "intent": "impolite",
          "intents": [
            "impolite"
          ]
        },
        {
          "raw_text": "bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
          "keywords": [],
          "index": 5,
          "channel": 1,
          "text": "alo alo bắt máy để im lặng gác máy trước bên phía ngân hàng sẽ tiếp tục gọi lại sau",
          "intent": "impolite",
          "intents": [
            "impolite"
          ]
        }
      ],
      "slots": {},
      "position_range_index": [],
      "position_condition": [],
      "task": "context_analysis"
    },
    "BUCKET_OR_REGION": "B3"
  }]

kw = [
  {
    "bucket": "Predue",
    "items": [
      "ăn cơm hay ăn",
      "con kia",
      "âm mưu lừa đảo",
      "âm mưu trốn nợ",
      "ăn của người ta",
      "ăn dốc nói láo",
      "ăn gì tôi cúng",
      "ăn gì tui cúng",
      "ăn giựt tiền",
      "ăn quỵt tiền"
    ]
  },
  {
    "bucket": "B0 Promo",
    "items": [
      "ăn cơm hay ăn",
      "con kia",
      "âm mưu lừa đảo",
      "âm mưu trốn nợ",
      "ăn của người ta",
      "ăn dốc nói láo",
      "ăn gì tôi cúng",
      "ăn gì tui cúng",
      "ăn giựt tiền",
      "ăn quỵt tiền"
    ]
  },
  {
    "bucket": "B3",
    "items": [
      "ăn cơm hay ăn",
      "con kia",
      "âm mưu lừa đảo",
      "âm mưu trốn nợ",
      "ăn của người ta",
      "ăn dốc nói láo",
      "ăn gì tôi cúng",
      "ăn gì tui cúng",
      "ăn giựt tiền",
      "im lặng"
    ]
  }
]

result = []
for item in data:
    # nếu decision trả về "no" thì result = yes do không tìm thấy keyword hoặc intent = polite
    if (item["searchInvalidKeyword"]["decision"]) == "no":
        result.append({
            "type": "case không vi phạm",
            "file_name": item["fileName"],
            "result": "Yes"
        })
    else:
      for entry in data:
        bucket_or_region = entry.get("BUCKET_OR_REGION")
        text = " ".join([item["text"] for item in entry["context_analysis"]["searchInvalidKeyword"]])

        match_found = False
        invalid_keyword = ""
        for bucket in kw:
          if bucket["bucket"] == bucket_or_region:
            for keyword in sorted(bucket["items"], key=len, reverse=True):
              if keyword in text:
                match_found = True
                invalid_keyword = keyword
                break
          if match_found:
            break

        result.append({
          "fileName": entry["fileName"],
          "result": "yes" if match_found else "no",
          "invalid_keyword": invalid_keyword if match_found else None
        })

print(result)